import{r as t,c as e,h as i,H as n}from"./p-108c0583.js";function s(t,e,i){return t(i={path:e,exports:{},require:function(){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},i.exports),i.exports}var r=s((function(t){(t.exports={}).forEach=function(t,e){for(var i=0;i<t.length;i++){var n=e(t[i]);if(n)return n}}})),o=s((function(t){var e=t.exports={};e.isIE=function(t){return!(-1===(e=navigator.userAgent.toLowerCase()).indexOf("msie")&&-1===e.indexOf("trident")&&-1===e.indexOf(" edge/")||t&&t!==function(){var t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(i[0]);return t>4?t:void 0}());var e},e.isLegacyOpera=function(){return!!window.opera}})),h=s((function(t){(t.exports={}).getOption=function(t,e,i){var n=t[e];return null==n&&void 0!==i?i:n}}));function c(){var t={},e=0,i=0,n=0;return{add:function(s,r){r||(r=s,s=0),s>i?i=s:s<n&&(n=s),t[s]||(t[s]=[]),t[s].push(r),e++},process:function(){for(var e=n;e<=i;e++)for(var s=t[e],r=0;r<s.length;r++)(0,s[r])()},size:function(){return e}}}function u(t){return t._erd}var a={initState:function(t){return t._erd={},u(t)},getState:u,cleanState:function(t){delete t._erd}},l=r.forEach,f=r.forEach;function d(t){return Array.isArray(t)||void 0!==t.length}function b(t){if(Array.isArray(t))return t;var e=[];return f(t,(function(t){e.push(t)})),e}function m(t){return t&&1===t.nodeType}function v(t,e,i){var n=t[e];return null==n&&void 0!==i?i:n}var p=s((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.sanitizeUrl=void 0;var i=/^(%20|\s)*(javascript|data|vbscript)/im,n=/[^\x20-\x7EÀ-ž]/gim,s=/^([^:]+):/gm,r=[".","/"];e.sanitizeUrl=function(t){if(!t)return"about:blank";var e=t.replace(n,"").trim();if(function(t){return r.indexOf(t[0])>-1}(e))return e;var o=e.match(s);return o&&i.test(o[0])?"about:blank":e}}));function y(t){return"function"==typeof t}let w=!1;const g={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else w&&console.log("RxJS: Back to a better error behavior. Thank you. <3");w=t},get useDeprecatedSynchronousErrorHandling(){return w}};function x(t){setTimeout(()=>{throw t},0)}const _={closed:!0,next(t){},error(t){if(g.useDeprecatedSynchronousErrorHandling)throw t;x(t)},complete(){}},E=Array.isArray||(t=>t&&"number"==typeof t.length);function S(t){return null!==t&&"object"==typeof t}const k=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();class z{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:e,_ctorUnsubscribe:i,_unsubscribe:n,_subscriptions:s}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,e instanceof z)e.remove(this);else if(null!==e)for(let o=0;o<e.length;++o)e[o].remove(this);if(y(n)){i&&(this._unsubscribe=void 0);try{n.call(this)}catch(r){t=r instanceof k?A(r.errors):[r]}}if(E(s)){let e=-1,i=s.length;for(;++e<i;){const i=s[e];if(S(i))try{i.unsubscribe()}catch(r){t=t||[],r instanceof k?t=t.concat(A(r.errors)):t.push(r)}}}if(t)throw new k(t)}add(t){let e=t;if(!t)return z.EMPTY;switch(typeof t){case"function":e=new z(t);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof z)){const t=e;e=new z,e._subscriptions=[t]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:i}=e;if(null===i)e._parentOrParents=this;else if(i instanceof z){if(i===this)return e;e._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return e;i.push(this)}const n=this._subscriptions;return null===n?this._subscriptions=[e]:n.push(e),e}remove(t){const e=this._subscriptions;if(e){const i=e.indexOf(t);-1!==i&&e.splice(i,1)}}}function A(t){return t.reduce((t,e)=>t.concat(e instanceof k?e.errors:e),[])}z.EMPTY=function(t){return t.closed=!0,t}(new z);const C="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class I extends z{constructor(t,e,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=_;break;case 1:if(!t){this.destination=_;break}if("object"==typeof t){t instanceof I?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new j(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new j(this,t,e,i)}}[C](){return this}static create(t,e,i){const n=new I(t,e,i);return n.syncErrorThrowable=!1,n}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class j extends I{constructor(t,e,i,n){let s;super(),this._parentSubscriber=t;let r=this;y(e)?s=e:e&&(s=e.next,i=e.error,n=e.complete,e!==_&&(r=Object.create(e),y(r.unsubscribe)&&this.add(r.unsubscribe.bind(r)),r.unsubscribe=this.unsubscribe.bind(this))),this._context=r,this._next=s,this._error=i,this._complete=n}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;g.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:i}=g;if(this._error)i&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)i?(e.syncErrorValue=t,e.syncErrorThrown=!0):x(t),this.unsubscribe();else{if(this.unsubscribe(),i)throw t;x(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);g.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(i){if(this.unsubscribe(),g.useDeprecatedSynchronousErrorHandling)throw i;x(i)}}__tryOrSetError(t,e,i){if(!g.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,i)}catch(n){return g.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=n,t.syncErrorThrown=!0,!0):(x(n),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const O="function"==typeof Symbol&&Symbol.observable||"@@observable";function D(t){return t}class H{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const e=new H;return e.source=this,e.operator=t,e}subscribe(t,e,i){const{operator:n}=this,s=function(t,e,i){if(t){if(t instanceof I)return t;if(t[C])return t[C]()}return t||e||i?new I(t,e,i):new I(_)}(t,e,i);if(s.add(n?n.call(s,this.source):this.source||g.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),g.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s}_trySubscribe(t){try{return this._subscribe(t)}catch(e){g.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:i,isStopped:n}=t;if(e||n)return!1;t=i&&i instanceof I?i:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=M(e))((e,i)=>{let n;n=this.subscribe(e=>{try{t(e)}catch(s){i(s),n&&n.unsubscribe()}},i,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[O](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?D:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=M(t))((t,e)=>{let i;this.subscribe(t=>i=t,t=>e(t),()=>t(i))})}}function M(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}H.create=t=>new H(t);const T=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class N extends z{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const i=e.indexOf(this.subscriber);-1!==i&&e.splice(i,1)}}class L extends I{constructor(t){super(t),this.destination=t}}class P extends H{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[C](){return new L(this)}lift(t){const e=new R(this,this);return e.operator=t,e}next(t){if(this.closed)throw new T;if(!this.isStopped){const{observers:e}=this,i=e.length,n=e.slice();for(let s=0;s<i;s++)n[s].next(t)}}error(t){if(this.closed)throw new T;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,i=e.length,n=e.slice();for(let s=0;s<i;s++)n[s].error(t);this.observers.length=0}complete(){if(this.closed)throw new T;this.isStopped=!0;const{observers:t}=this,e=t.length,i=t.slice();for(let n=0;n<e;n++)i[n].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new T;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new T;return this.hasError?(t.error(this.thrownError),z.EMPTY):this.isStopped?(t.complete(),z.EMPTY):(this.observers.push(t),new N(this,t))}asObservable(){const t=new H;return t.source=this,t}}P.create=(t,e)=>new R(t,e);class R extends P{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):z.EMPTY}}class q extends z{constructor(t,e){super()}schedule(t,e=0){return this}}class U{constructor(t,e=U.now){this.SchedulerAction=t,this.now=e}schedule(t,e=0,i){return new this.SchedulerAction(this,t).schedule(i,e)}}U.now=()=>Date.now();class B extends U{constructor(t,e=U.now){super(t,()=>B.delegate&&B.delegate!==this?B.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,i){return B.delegate&&B.delegate!==this?B.delegate.schedule(t,e,i):super.schedule(t,e,i)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let i;this.active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}const W=new H(t=>t.complete());function $(t){return t&&"function"==typeof t.schedule}const J=t=>e=>{for(let i=0,n=t.length;i<n&&!e.closed;i++)e.next(t[i]);e.complete()};function Y(t,e){return new H(i=>{const n=new z;let s=0;return n.add(e.schedule((function(){s!==t.length?(i.next(t[s++]),i.closed||n.add(this.schedule())):i.complete()}))),n})}const F=new B(class extends q{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this}requestAsyncId(t,e,i=0){return setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let i=!1,n=void 0;try{this.work(t)}catch(s){i=!0,n=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),n}_unsubscribe(){const t=this.id,e=this.scheduler,i=e.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}});function G(){}const K=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function V(t,e){return function(i){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new Q(t,e))}}class Q{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new X(t,this.project,this.thisArg))}}class X extends I{constructor(t,e,i){super(t),this.project=e,this.count=0,this.thisArg=i||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}const Z="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",tt=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function et(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const it=t=>{if(t&&"function"==typeof t[O])return n=t,t=>{const e=n[O]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(tt(t))return J(t);if(et(t))return i=t,t=>(i.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,x),t);if(t&&"function"==typeof t[Z])return e=t,t=>{const i=e[Z]();for(;;){let e;try{e=i.next()}catch(n){return t.error(n),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof i.return&&t.add(()=>{i.return&&i.return()}),t};{const e=S(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,i,n};function nt(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[O]}(t))return function(t,e){return new H(i=>{const n=new z;return n.add(e.schedule(()=>{const s=t[O]();n.add(s.subscribe({next(t){n.add(e.schedule(()=>i.next(t)))},error(t){n.add(e.schedule(()=>i.error(t)))},complete(){n.add(e.schedule(()=>i.complete()))}}))})),n})}(t,e);if(et(t))return function(t,e){return new H(i=>{const n=new z;return n.add(e.schedule(()=>t.then(t=>{n.add(e.schedule(()=>{i.next(t),n.add(e.schedule(()=>i.complete()))}))},t=>{n.add(e.schedule(()=>i.error(t)))}))),n})}(t,e);if(tt(t))return Y(t,e);if(function(t){return t&&"function"==typeof t[Z]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new H(i=>{const n=new z;let s;return n.add(()=>{s&&"function"==typeof s.return&&s.return()}),n.add(e.schedule(()=>{s=t[Z](),n.add(e.schedule((function(){if(i.closed)return;let t,e;try{const i=s.next();t=i.value,e=i.done}catch(n){return void i.error(n)}e?i.complete():(i.next(t),this.schedule())})))})),n})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof H?t:new H(it(t))}class st extends I{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class rt extends I{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function ot(t,e){if(!e.closed)return t instanceof H?t.subscribe(e):it(t)(e)}class ht{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new ct(t,this.project,this.concurrent))}}class ct extends rt{constructor(t,e,i=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const i=this.index++;try{e=this.project(t,i)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(e)}_innerSub(t){const e=new st(this),i=this.destination;i.add(e);const n=ot(t,e);n!==e&&i.add(n)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function ut(t,e){return new H(i=>{const n=t.length;if(0===n)return void i.complete();const s=new Array(n);let r=0,o=0;for(let h=0;h<n;h++){const c=nt(t[h]);let u=!1;i.add(c.subscribe({next:t=>{u||(u=!0,o++),s[h]=t},error:t=>i.error(t),complete:()=>{r++,r!==n&&u||(o===n&&i.next(e?e.reduce((t,e,i)=>(t[e]=s[i],t),{}):s),i.complete())}}))}})}function at(t,e,i,n){return y(i)&&(n=i,i=void 0),n?at(t,e,i).pipe(V(t=>E(t)?n(...t):n(t))):new H(n=>{!function t(e,i,n,s,r){let o;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(e)){const t=e;e.addEventListener(i,n,r),o=()=>t.removeEventListener(i,n,r)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(e)){const t=e;e.on(i,n),o=()=>t.off(i,n)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(e)){const t=e;e.addListener(i,n),o=()=>t.removeListener(i,n)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let o=0,h=e.length;o<h;o++)t(e[o],i,n,s,r)}s.add(o)}(t,e,(function(t){n.next(arguments.length>1?Array.prototype.slice.call(arguments):t)}),n,i)})}function lt(t){return!E(t)&&t-parseFloat(t)+1>=0}function ft(...t){let e=Number.POSITIVE_INFINITY,i=null,n=t[t.length-1];return $(n)?(i=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof n&&(e=t.pop()),null===i&&1===t.length&&t[0]instanceof H?t[0]:function(t=Number.POSITIVE_INFINITY){return function t(e,i,n=Number.POSITIVE_INFINITY){return"function"==typeof i?s=>s.pipe(t((t,n)=>nt(e(t,n)).pipe(V((e,s)=>i(t,e,n,s))),n)):("number"==typeof i&&(n=i),t=>t.lift(new ht(e,n)))}(D,t)}(e)(function(t,e){return e?Y(t,e):new H(J(t))}(t,i))}function dt(t=0,e,i){let n=-1;return lt(e)?n=Number(e)<1?1:Number(e):$(e)&&(i=e),$(i)||(i=F),new H(e=>{const s=lt(t)?t:+t-i.now();return i.schedule(bt,s,{index:0,period:n,subscriber:e})})}function bt(t){const{index:e,period:i,subscriber:n}=t;if(n.next(e),!n.closed){if(-1===i)return n.complete();t.index=e+1,this.schedule(t,i)}}class mt{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new vt(t,this.durationSelector))}}class vt extends rt{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1}_next(t){try{const e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(e){this.destination.error(e)}}_complete(){this.emitValue(),this.destination.complete()}_tryNext(t,e){let i=this.durationSubscription;this.value=t,this.hasValue=!0,i&&(i.unsubscribe(),this.remove(i)),i=ot(e,new st(this)),i&&!i.closed&&this.add(this.durationSubscription=i)}notifyNext(){this.emitValue()}notifyComplete(){this.emitValue()}emitValue(){if(this.hasValue){const t=this.value,e=this.durationSubscription;e&&(this.durationSubscription=void 0,e.unsubscribe(),this.remove(e)),this.value=void 0,this.hasValue=!1,super._next(t)}}}function pt(t){return e=>{return 0===t?i?function(t){return new H(e=>t.schedule(()=>e.complete()))}(i):W:e.lift(new yt(t));var i}}class yt{constructor(t){if(this.total=t,this.total<0)throw new K}call(t,e){return e.subscribe(new wt(t,this.total))}}class wt extends I{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,i=++this.count;i<=e&&(this.destination.next(t),i===e&&(this.destination.complete(),this.unsubscribe()))}}class gt{constructor(t){this.project=t}call(t,e){return e.subscribe(new xt(t,this.project))}}class xt extends rt{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const i=this.index++;try{e=this.project(t,i)}catch(n){return void this.destination.error(n)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const i=new st(this),n=this.destination;n.add(i),this.innerSubscription=ot(t,i),this.innerSubscription!==i&&n.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}function _t(t){return e=>e.lift(new Et(t))}class Et{constructor(t){this.notifier=t}call(t,e){const i=new St(t),n=ot(this.notifier,new st(i));return n&&!i.seenValue?(i.add(n),e.subscribe(i)):i}}class St extends rt{constructor(t){super(t),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}class kt{constructor(t,e,i){this.nextOrObserver=t,this.error=e,this.complete=i}call(t,e){return e.subscribe(new zt(t,this.nextOrObserver,this.error,this.complete))}}class zt extends I{constructor(t,e,i,n){super(t),this._tapNext=G,this._tapError=G,this._tapComplete=G,this._tapError=i||G,this._tapComplete=n||G,y(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||G,this._tapError=e.error||G,this._tapComplete=e.complete||G)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}const At=function(t){var e,i;if((t=t||{}).idHandler)e={get:function(e){return t.idHandler.get(e,!0)},set:t.idHandler.set};else{var n=function(t){var e=t.idGenerator,i=t.stateHandler.getState;return{get:function(t){var e=i(t);return e&&void 0!==e.id?e.id:null},set:function(t){var n=i(t);if(!n)throw new Error("setId required the element to have a resize detection state.");var s=e.generate();return n.id=s,s}}}({idGenerator:(i=1,{generate:function(){return i++}}),stateHandler:a});e=n}var s=t.reporter;s||(s=function(t){function e(){}var i={log:e,warn:e,error:e};if(!t&&window.console){var n=function(t,e){t[e]=function(){var t=console[e];if(t.apply)t.apply(console,arguments);else for(var i=0;i<arguments.length;i++)t(arguments[i])}};n(i,"log"),n(i,"warn"),n(i,"error")}return i}(!1===s));var r=v(t,"batchProcessor",function(t){var e=(t=t||{}).reporter,i=h.getOption(t,"async",!0),n=h.getOption(t,"auto",!0);n&&!i&&(e&&e.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),i=!0);var s,r=c(),o=!1;function u(){for(o=!0;r.size();){var t=r;r=c(),t.process()}o=!1}function a(){s=setTimeout(u,0)}return{add:function(t,e){!o&&n&&i&&0===r.size()&&a(),r.add(t,e)},force:function(t){o||(void 0===t&&(t=i),s&&(clearTimeout(s),s=null),t?a():u())}}}({reporter:s})),u={};u.callOnAdd=!!v(t,"callOnAdd",!0),u.debug=!!v(t,"debug",!1);var p,y=function(t){var e={};function i(i){var n=t.get(i);return void 0===n?[]:e[n]||[]}return{get:i,add:function(i,n){var s=t.get(i);e[s]||(e[s]=[]),e[s].push(n)},removeListener:function(t,e){for(var n=i(t),s=0,r=n.length;s<r;++s)if(n[s]===e){n.splice(s,1);break}},removeAllListeners:function(t){var e=i(t);e&&(e.length=0)}}}(e),w=function(){var t={stateHandler:a}.stateHandler.getState;return{isDetectable:function(e){var i=t(e);return i&&!!i.isDetectable},markAsDetectable:function(e){t(e).isDetectable=!0},isBusy:function(e){return!!t(e).busy},markBusy:function(e,i){t(e).busy=!!i}}}(),g=v(t,"strategy","object"),x=v(t,"important",!1),_={reporter:s,batchProcessor:r,stateHandler:a,idHandler:e,important:x};if("scroll"===g&&(o.isLegacyOpera()?(s.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),g="object"):o.isIE(9)&&(s.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),g="object")),"scroll"===g)p=function(t){var e=(t=t||{}).reporter,i=t.batchProcessor,n=t.stateHandler.getState,s=t.idHandler;if(!i)throw new Error("Missing required dependency: batchProcessor");if(!e)throw new Error("Missing required dependency: reporter.");var r=function(){var t=document.createElement("div");t.style.cssText=c(["position: absolute","width: 1000px","height: 1000px","visibility: hidden","margin: 0","padding: 0"]);var e=document.createElement("div");e.style.cssText=c(["position: absolute","width: 500px","height: 500px","overflow: scroll","visibility: none","top: -1500px","left: -1500px","visibility: hidden","margin: 0","padding: 0"]),e.appendChild(t),document.body.insertBefore(e,document.body.firstChild);var i=500-e.clientWidth,n=500-e.clientHeight;return document.body.removeChild(e),{width:i,height:n}}(),o="erd_scroll_detection_container";function h(t){!function(t,e,i){if(!t.getElementById(e)){var n=i+"_animation",s="/* Created by the element-resize-detector library. */\n";s+="."+i+" > div::-webkit-scrollbar { "+c(["display: none"])+" }\n\n",s+=".erd_scroll_detection_container_animation_active { "+c(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+n,"animation-name: "+n])+" }\n",s+="@-webkit-keyframes "+n+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",function(i,n){n=n||function(e){t.head.appendChild(e)};var s=t.createElement("style");s.innerHTML=i,s.id=e,n(s)}(s+="@keyframes "+n+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}}(t,"erd_scroll_detection_scrollbar_style",o)}function c(e){var i=t.important?" !important; ":"; ";return(e.join(i)+i).trim()}function u(t,i,n){if(t.addEventListener)t.addEventListener(i,n);else{if(!t.attachEvent)return e.error("[scroll] Don't know how to add event listeners.");t.attachEvent("on"+i,n)}}function a(t,i,n){if(t.removeEventListener)t.removeEventListener(i,n);else{if(!t.detachEvent)return e.error("[scroll] Don't know how to remove event listeners.");t.detachEvent("on"+i,n)}}function f(t){return n(t).container.childNodes[0].childNodes[0].childNodes[0]}function d(t){return n(t).container.childNodes[0].childNodes[0].childNodes[1]}return h(window.document),{makeDetectable:function(t,h,a){function b(){if(t.debug){var i=Array.prototype.slice.call(arguments);if(i.unshift(s.get(h),"Scroll: "),e.log.apply)e.log.apply(null,i);else for(var n=0;n<i.length;n++)e.log(i[n])}}function m(t){var e=n(t).container.childNodes[0],i=window.getComputedStyle(e);return!i.width||-1===i.width.indexOf("px")}function v(){var t=window.getComputedStyle(h),e={};return e.position=t.position,e.width=h.offsetWidth,e.height=h.offsetHeight,e.top=t.top,e.right=t.right,e.bottom=t.bottom,e.left=t.left,e.widthCSS=t.width,e.heightCSS=t.height,e}function p(){if(b("storeStyle invoked."),n(h)){var t=v();n(h).style=t}else b("Aborting because element has been uninstalled")}function y(t,e,i){n(t).lastWidth=e,n(t).lastHeight=i}function w(){return 2*r.width+1}function g(){return 2*r.height+1}function x(t){return t+10+w()}function _(t){return t+10+g()}function E(t,e,i){var n=f(t),s=d(t),r=x(e),o=_(i),h=function(t){return 2*t+w()}(e),c=function(t){return 2*t+g()}(i);n.scrollLeft=r,n.scrollTop=o,s.scrollLeft=h,s.scrollTop=c}function S(){var t=n(h).container;if(!t){(t=document.createElement("div")).className=o,t.style.cssText=c(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),n(h).container=t,function(t){t.className+=" "+o+"_animation_active"}(t),h.appendChild(t);var e=function(){n(h).onRendered&&n(h).onRendered()};u(t,"animationstart",e),n(h).onAnimationStart=e}return t}function k(){if(b("Injecting elements"),n(h)){!function(){var i=n(h).style;if("static"===i.position){h.style.setProperty("position","relative",t.important?"important":"");var s=function(t,e,i,n){var s=i[n];"auto"!==s&&"0"!==function(t){return t.replace(/[^-\d\.]/g,"")}(s)&&(t.warn("An element that is positioned static has style."+n+"="+s+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+n+" will be set to 0. Element: ",e),e.style[n]=0)};s(e,h,i,"top"),s(e,h,i,"right"),s(e,h,i,"bottom"),s(e,h,i,"left")}}();var i=n(h).container;i||(i=S());var s,a,l,f,d=r.width,m=r.height,v=c(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),p=c(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(["left: "+(s=(s=-(1+d))?s+"px":"0"),"top: "+(a=(a=-(1+m))?a+"px":"0"),"right: "+(f=(f=-d)?f+"px":"0"),"bottom: "+(l=(l=-m)?l+"px":"0")])),y=c(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),w=c(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),g=c(["position: absolute","left: 0","top: 0"]),x=c(["position: absolute","width: 200%","height: 200%"]),_=document.createElement("div"),E=document.createElement("div"),k=document.createElement("div"),z=document.createElement("div"),A=document.createElement("div"),C=document.createElement("div");_.dir="ltr",_.style.cssText=v,_.className=o,E.className=o,E.style.cssText=p,k.style.cssText=y,z.style.cssText=g,A.style.cssText=w,C.style.cssText=x,k.appendChild(z),A.appendChild(C),E.appendChild(k),E.appendChild(A),_.appendChild(E),i.appendChild(_),u(k,"scroll",I),u(A,"scroll",j),n(h).onExpandScroll=I,n(h).onShrinkScroll=j}else b("Aborting because element has been uninstalled");function I(){n(h).onExpand&&n(h).onExpand()}function j(){n(h).onShrink&&n(h).onShrink()}}function z(){function r(e,i,n){var s=function(t){return f(t).childNodes[0]}(e),r=x(i),o=_(n);s.style.setProperty("width",r+"px",t.important?"important":""),s.style.setProperty("height",o+"px",t.important?"important":"")}function o(o){var u=h.offsetWidth,a=h.offsetHeight,l=u!==n(h).lastWidth||a!==n(h).lastHeight;b("Storing current size",u,a),y(h,u,a),i.add(0,(function(){l&&(n(h)?c()?(t.debug&&(h.offsetWidth===u&&h.offsetHeight===a||e.warn(s.get(h),"Scroll: Size changed before updating detector elements.")),r(h,u,a)):b("Aborting because element container has not been initialized"):b("Aborting because element has been uninstalled"))})),i.add(1,(function(){n(h)?c()?E(h,u,a):b("Aborting because element container has not been initialized"):b("Aborting because element has been uninstalled")})),l&&o&&i.add(2,(function(){n(h)?c()?o():b("Aborting because element container has not been initialized"):b("Aborting because element has been uninstalled")}))}function c(){return!!n(h).container}function u(){b("notifyListenersIfNeeded invoked");var t=n(h);return void 0===n(h).lastNotifiedWidth&&t.lastWidth===t.startSize.width&&t.lastHeight===t.startSize.height?b("Not notifying: Size is the same as the start size, and there has been no notification yet."):t.lastWidth===t.lastNotifiedWidth&&t.lastHeight===t.lastNotifiedHeight?b("Not notifying: Size already notified"):(b("Current size not notified, notifying..."),t.lastNotifiedWidth=t.lastWidth,t.lastNotifiedHeight=t.lastHeight,void l(n(h).listeners,(function(t){t(h)})))}function a(){b("Scroll detected."),m(h)?b("Scroll event fired while unrendered. Ignoring..."):o(u)}if(b("registerListenersAndPositionElements invoked."),n(h)){n(h).onRendered=function(){if(b("startanimation triggered."),m(h))b("Ignoring since element is still unrendered...");else{b("Element rendered.");var t=f(h),e=d(h);0!==t.scrollLeft&&0!==t.scrollTop&&0!==e.scrollLeft&&0!==e.scrollTop||(b("Scrollbars out of sync. Updating detector elements..."),o(u))}},n(h).onExpand=a,n(h).onShrink=a;var v=n(h).style;r(h,v.width,v.height)}else b("Aborting because element has been uninstalled")}function A(){if(b("finalizeDomMutation invoked."),n(h)){var t=n(h).style;y(h,t.width,t.height),E(h,t.width,t.height)}else b("Aborting because element has been uninstalled")}function C(){a(h)}function I(){var t;b("Installing..."),n(h).listeners=[],t=v(),n(h).startSize={width:t.width,height:t.height},b("Element start size",n(h).startSize),i.add(0,p),i.add(1,k),i.add(2,z),i.add(3,A),i.add(4,C)}a||(a=h,h=t,t=null),t=t||{},b("Making detectable..."),function(t){return!function(t){return t===t.ownerDocument.body||t.ownerDocument.body.contains(t)}(t)||null===window.getComputedStyle(t)}(h)?(b("Element is detached"),S(),b("Waiting until element is attached..."),n(h).onRendered=function(){b("Element is now attached"),I()}):I()},addListener:function(t,e){if(!n(t).listeners.push)throw new Error("Cannot add listener to an element that is not detectable.");n(t).listeners.push(e)},uninstall:function(t){var e=n(t);e&&(e.onExpandScroll&&a(f(t),"scroll",e.onExpandScroll),e.onShrinkScroll&&a(d(t),"scroll",e.onShrinkScroll),e.onAnimationStart&&a(e.container,"animationstart",e.onAnimationStart),e.container&&t.removeChild(e.container))},initDocument:h}}(_);else{if("object"!==g)throw new Error("Invalid strategy name: "+g);p=function(t){var e=(t=t||{}).reporter,i=t.batchProcessor,n=t.stateHandler.getState;if(!e)throw new Error("Missing required dependency: reporter.");function s(e){var i=t.important?" !important; ":"; ";return(e.join(i)+i).trim()}function r(t){return n(t).object}return{makeDetectable:function(t,r,h){h||(h=r,r=t,t=null),t=t||{},o.isIE(8)?h(r):function(r,h){var c=s(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),u=!1,a=window.getComputedStyle(r),l=r.offsetWidth,f=r.offsetHeight;function d(){function i(){if("static"===a.position){r.style.setProperty("position","relative",t.important?"important":"");var i=function(e,i,n,s){var r=n[s];"auto"!==r&&"0"!==function(t){return t.replace(/[^-\d\.]/g,"")}(r)&&(e.warn("An element that is positioned static has style."+s+"="+r+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+s+" will be set to 0. Element: ",i),i.style.setProperty(s,"0",t.important?"important":""))};i(e,r,a,"top"),i(e,r,a,"right"),i(e,r,a,"bottom"),i(e,r,a,"left")}}""!==a.position&&(i(),u=!0);var s=document.createElement("object");s.style.cssText=c,s.tabIndex=-1,s.type="text/html",s.setAttribute("aria-hidden","true"),s.onload=function(){u||i(),function t(e,i){if(!e.contentDocument){var s=n(e);return s.checkForObjectDocumentTimeoutId&&window.clearTimeout(s.checkForObjectDocumentTimeoutId),void(s.checkForObjectDocumentTimeoutId=setTimeout((function(){s.checkForObjectDocumentTimeoutId=0,t(e,i)}),100))}i(e.contentDocument)}(this,(function(){h(r)}))},o.isIE()||(s.data="about:blank"),n(r)&&(r.appendChild(s),n(r).object=s,o.isIE()&&(s.data="about:blank"))}n(r).startSize={width:l,height:f},i?i.add(d):d()}(r,h)},addListener:function(t,e){function i(){e(t)}if(o.isIE(8))n(t).object={proxy:i},t.attachEvent("onresize",i);else{var s=r(t);if(!s)throw new Error("Element is not detectable by this strategy.");s.contentDocument.defaultView.addEventListener("resize",i)}},uninstall:function(t){if(n(t)){var e=r(t);e&&(o.isIE(8)?t.detachEvent("onresize",e.proxy):t.removeChild(e),n(t).checkForObjectDocumentTimeoutId&&window.clearTimeout(n(t).checkForObjectDocumentTimeoutId),delete n(t).object)}}}}(_)}var E={};return{listenTo:function(t,i,n){function r(t){var e=y.get(t);f(e,(function(e){e(t)}))}function o(t,e,i){y.add(e,i),t&&i(e)}if(n||(n=i,i=t,t={}),!i)throw new Error("At least one element required.");if(!n)throw new Error("Listener required.");if(m(i))i=[i];else{if(!d(i))return s.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");i=b(i)}var h=0,c=v(t,"callOnAdd",u.callOnAdd),l=v(t,"onReady",(function(){})),g=v(t,"debug",u.debug);f(i,(function(t){a.getState(t)||(a.initState(t),e.set(t));var u=e.get(t);if(g&&s.log("Attaching listener to element",u,t),!w.isDetectable(t))return g&&s.log(u,"Not detectable."),w.isBusy(t)?(g&&s.log(u,"System busy making it detectable"),o(c,t,n),E[u]=E[u]||[],void E[u].push((function(){++h===i.length&&l()}))):(g&&s.log(u,"Making detectable..."),w.markBusy(t,!0),p.makeDetectable({debug:g,important:x},t,(function(t){if(g&&s.log(u,"onElementDetectable"),a.getState(t)){w.markAsDetectable(t),w.markBusy(t,!1),p.addListener(t,r),o(c,t,n);var e=a.getState(t);e&&e.startSize&&(e.startSize.width===t.offsetWidth&&e.startSize.height===t.offsetHeight||r(t)),E[u]&&f(E[u],(function(t){t()}))}else g&&s.log(u,"Element uninstalled before being detectable.");delete E[u],++h===i.length&&l()})));g&&s.log(u,"Already detecable, adding listener."),o(c,t,n),h++})),h===i.length&&l()},removeListener:y.removeListener,removeAllListeners:y.removeAllListeners,uninstall:function(t){if(!t)return s.error("At least one element is required.");if(m(t))t=[t];else{if(!d(t))return s.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");t=b(t)}f(t,(function(t){y.removeAllListeners(t),p.uninstall(t),a.cleanState(t)}))},initDocument:function(t){p.initDocument&&p.initDocument(t)}}}({strategy:"scroll"}),Ct=class{constructor(i){t(this,i),this.magicIframeEvent=e(this,"magicIframeEvent",7),this.ua=window.navigator.userAgent,this.msie=this.ua.indexOf("MSIE "),this.isIe=this.msie>0||!!navigator.userAgent.match(/Trident.*rv\:11\./),this.autoResize=!0,this.resizeDebounce=0,this.scaleContent=!1,this.scaleDebounce=0,this.matchContentWidth=!1,this.sanitizeSource=!0,this.maxHeight="10000vh",this.reloadOnChange=!1,this.debug=!1,this.loaded=!1,this.loading=!0,this.pageTitle="SEB Magic Iframe",this._scale=1,this._hasBodyWidthRule=!1,this._stylesheets=[],this._unsubscribe$=new P}sourceChangeHandler(t,e){t&&e&&t.split("?")[0]!==e.split("?")[0]||t&&!e?this.loaded=!1:this.reloadOnChange&&t!==e&&setTimeout(()=>this.iframe.contentDocument.location.reload(),200)}scaleContentChangeHandler(t,e){t!==e&&(this.scale(),t&&(this.matchContentWidth=!1))}stylesChangeHandler(t,e){t!==e&&this.addCss()}styleUrlsChangeHandler(t,e){t!==e&&this.addStyleSheets()}autoResizeChangeHandler(t,e){t!==e&&(t?0===this.iframe.contentDocument.body.getElementsByClassName("erd_scroll_detection_container").length&&this.addElementResizeDetector(this.iframe.contentDocument.body,this.iframe.contentWindow.getComputedStyle(this.iframe.contentDocument.body)):this.removeElementResizeDetector())}matchContentWidthChangeHandler(t,e){t!==e&&this.hasBodyWidthRule()}loadedHandler(t,e){if(t!==e&&t){if(this.preventOverflow())return;this.magicIframeEventHandler({event:"iframe-loaded",details:this._loadEvent});const t=this.iframe.contentDocument.title;t!==this.pageTitle&&(this.pageTitle=t,this.magicIframeEventHandler({event:"iframe-title-change",details:t})),this.addCss(),this.addStyleSheets(),this.autoResize&&this.addElementResizeDetector(this.iframe.contentDocument.body,this.iframe.contentWindow.getComputedStyle(this.iframe.contentDocument.body)),this.addUnloadListener(),this.addClickListener(),this.addKeyUpListener(),this.scale()}else this.loading=!0}magicIframeEventHandler(t){this.debug&&console.log(t),this.magicIframeEvent.emit(t)}onIframeLoad(t){this._loadEvent=t,this.loaded=!0}getSafeSrc(){return this.sanitizeSource?p.sanitizeUrl(this.source):this.source}render(){return i(n,{class:{loading:this.loading}},this.source?i("div",{style:this.loading&&{overflow:"hidden",position:"relative"}},i("div",{class:{"seb-iframe-loading":this.loading},style:!this.loading&&{visibility:"hidden"}},i("slot",null)),i("iframe",{src:this.getSafeSrc(),ref:t=>this.iframe=t,class:"seb-iframe",frameborder:"0",scrolling:"no",title:this.pageTitle,onLoad:t=>this.onIframeLoad(t)})):null)}addElementResizeDetector(t,e){At.listenTo(t,()=>{clearTimeout(this._resizeDebounceTimeout),this._resizeDebounceTimeout=setTimeout(()=>this.updateSize(e),this.resizeDebounce)})}updateSize(t){const e=t||this.iframe.contentWindow.getComputedStyle(this.iframe.contentDocument.body),i=(this.iframe.contentDocument.body.offsetHeight+parseInt(e.getPropertyValue("margin-top"),10)+parseInt(e.getPropertyValue("margin-bottom"),10))*this._scale,n=this.iframe.contentDocument.body.offsetWidth;this.iframe.style.height=i+"px",this.iframe.style.maxHeight=this.maxHeight,this.iframe.style.minWidth=!1!==this.matchContentWidth&&this._hasBodyWidthRule&&n&&!this.scaleContent||this.minWidth?this.minWidth||n+"px":"100%",this.magicIframeEventHandler({event:"iframe-resized",details:{width:n,height:i}})}addUnloadListener(){var t;this.isIe&&at(this.iframe.contentWindow,"beforeunload").pipe((t=()=>{this.iframe.style.visibility="hidden",this.loading=!0},function(e){return e.lift(new kt(t,undefined,undefined))}),function t(e,i){return"function"==typeof i?n=>n.pipe(t((t,n)=>nt(e(t,n)).pipe(V((e,s)=>i(t,e,n,s))))):t=>t.lift(new gt(e))}(()=>dt(3e3)),_t(ft(at(this.iframe.contentWindow,"unload"),this._unsubscribe$))).subscribe(()=>{this.iframe.style.visibility="visible",this.loading=!1}),at(this.iframe.contentWindow,"unload").pipe(pt(1),_t(this._unsubscribe$)).subscribe(t=>{this.loaded=!1,this.iframe.style.visibility="hidden";try{this.iframe.contentDocument.body.style.overflow="hidden"}catch(e){}this.magicIframeEventHandler({event:"iframe-unloaded",details:t})})}addClickListener(){at(this.iframe.contentDocument,"click").pipe(_t(this._unsubscribe$)).subscribe(t=>{this.magicIframeEventHandler({event:"iframe-click",details:t})})}addKeyUpListener(){at(this.iframe.contentDocument,"keyup").pipe(_t(this._unsubscribe$)).subscribe(t=>{this.magicIframeEventHandler({event:"iframe-keyup",details:t})})}addCss(){if(this.styles&&this.styles.length>0){if(this._styleElement)try{this._styleElement.innerText=this.styles}catch(t){this._styleElement=document.createElement("style"),this._styleElement.setAttribute("id","sebMagicIframeStyles"),this._styleElement.appendChild(document.createTextNode(this.styles))}else this._styleElement=document.createElement("style"),this._styleElement.setAttribute("id","sebMagicIframeStyles"),this._styleElement.appendChild(document.createTextNode(this.styles));this.iframe.contentWindow.document.getElementsByTagName("head")[0].appendChild(this._styleElement),this.magicIframeEventHandler({event:"iframe-styles-added",details:this.styles})}else if(this._styleElement){let t=this.iframe.contentWindow.document.getElementById("sebMagicIframeStyles");t.parentNode.removeChild(t),this._styleElement=null,t=null,this.magicIframeEventHandler({event:"iframe-styles-removed",details:this.styles})}}preventOverflow(){try{const t=this.iframe.contentWindow.document.createElement("style");return this.iframe.contentWindow.document.body.style.position="static",this.styleElement=t,t.appendChild(document.createTextNode("html { overflow: hidden; }")),this.iframe.contentWindow.document.getElementsByTagName("head")[0].appendChild(t),!1}catch(t){return console.log("Event listeners and/or styles and resize listener could not be added due to a cross-origin frame error."),console.warn(t),this.magicIframeEventHandler({event:"iframe-loaded-with-errors",details:t}),this.iframe.style.visibility="visible",this.loading=!1,!0}}addStyleSheets(){if(this._stylesheets&&this._stylesheets.length>0){const t=this.iframe.contentDocument.head.querySelectorAll('link[data-seb-magic-iframe="true"]');if(t){for(let e=0;e<t.length;e++)t[e].parentNode.removeChild(t[e]);this.magicIframeEventHandler({event:"iframe-all-stylesheets-removed",details:this.styleUrls})}}if(this.styleUrls&&this.styleUrls.length>0){let t=[];this.styleUrls.map(e=>{const i=this.iframe.contentDocument.createElement("link");this._stylesheets=[...this._stylesheets,i],i.setAttribute("data-seb-magic-iframe","true"),i.rel="stylesheet",i.type="text/css",i.href=this.sanitizeSource?p.sanitizeUrl(e):e;const n=new P;t=[...t,n],at(i,"load").pipe(pt(1),_t(this._unsubscribe$)).subscribe(()=>{this.magicIframeEventHandler({event:"iframe-stylesheet-loaded",details:e}),n.next(e),n.complete()}),this.iframe.contentDocument.head.insertBefore(i,this.styleElement),this.magicIframeEventHandler({event:"iframe-stylesheet-load",details:e})}),function(...t){if(1===t.length){const e=t[0];if(E(e))return ut(e,null);if(S(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return ut(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return ut(t=1===t.length&&E(t[0])?t[0]:t,null).pipe(V(t=>e(...t)))}return ut(t,null)}(t).pipe(pt(1),_t(this._unsubscribe$)).subscribe(()=>{this.styleUrls.length>1&&this.magicIframeEventHandler({event:"iframe-all-stylesheets-loaded",details:this.styleUrls}),this.hasBodyWidthRule(),this.iframe.style.visibility="visible",this.loading=!1})}else this.hasBodyWidthRule(),this.iframe.style.visibility="visible",this.loading=!1}setScale(t){if(t)this._previousScale=t,this._scale=t;else{const t=this._previousScale&&this._hasBodyWidthRule?this._previousScale:this.iframe.clientWidth/this.iframe.contentDocument.body.offsetWidth;this._previousScale=null,this._scale=t>1?1:t}this.iframe.contentDocument.body.style.transformOrigin="top left",this.iframe.contentDocument.body.style.transform="scale3d("+this._scale+","+this._scale+",1)",this.updateSize(),(t||1!==this._scale)&&this.magicIframeEventHandler({event:"iframe-content-scaled",details:this._scale})}filterCssRuleBodyWidth(t){return t&&1===t.type&&"body"===t.selectorText&&(t.style.width||t.style.minWidth)}removeElementResizeDetector(){this.iframe.contentDocument.body&&At&&At.uninstall(this.iframe.contentDocument.body)}scale(){var t;this.scaleContent?(this.setScale(),this._resizeListener||(this._resizeListener=at(window,"resize").pipe((t=()=>dt(this.scaleDebounce),e=>e.lift(new mt(t))),_t(this._unsubscribe$)).subscribe(()=>this.setScale()))):!this.scaleContent&&this._resizeListener&&(this._resizeListener.unsubscribe(),this._resizeListener=null,this.setScale(1))}hasBodyWidthRule(){if("auto"!==this.matchContentWidth)return this._hasBodyWidthRule=this.matchContentWidth,void this.updateSize();try{let t=[].slice.call(this.iframe.contentDocument.styleSheets).reduce((t,e)=>e.cssRules?[...t,[].slice.call(e.cssRules).map(t=>4===t.type?[].slice.call(t.cssRules).filter(this.filterCssRuleBodyWidth).pop():t).filter(this.filterCssRuleBodyWidth).reduce((t,e)=>[...t,e.style.width||e.style.minWidth],[])]:[...t],[]);t=[].concat.apply([],t),this._hasBodyWidthRule=t.length>0,this.updateSize()}catch(t){console.log("Can't read css rules from stylesheet loaded from external domain."),console.warn(t)}}disconnectedCallback(){this.magicIframeEventHandler({event:"iframe-removed",details:this.iframe}),this._unsubscribe$.next(),this._unsubscribe$.complete()}static get watchers(){return{source:["sourceChangeHandler"],scaleContent:["scaleContentChangeHandler"],styles:["stylesChangeHandler"],styleUrls:["styleUrlsChangeHandler"],autoResize:["autoResizeChangeHandler"],matchContentWidth:["matchContentWidthChangeHandler"],loaded:["loadedHandler"]}}};Ct.style=":host{display:block;position:relative;-webkit-overflow-scrolling:touch;overflow:auto}.seb-iframe{overflow:hidden;min-width:100%;width:100px;*width:100%}.seb-iframe-loading{height:100%;width:100%;position:absolute;z-index:1}.seb-iframe-loading::after{background:#fff;content:'';display:block;height:100%;position:absolute;top:0;width:100%;z-index:-1;left:0}";export{Ct as seb_magic_iframe}