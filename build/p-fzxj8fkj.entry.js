import{r as t,c as e,h as i,H as n}from"./p-97f44cf9.js";function s(t,e){return t(e={exports:{}},e.exports),e.exports}var r=s((function(t){(t.exports={}).forEach=function(t,e){for(var i=0;i<t.length;i++){var n=e(t[i]);if(n)return n}}})),o=s((function(t){var e=t.exports={};e.isIE=function(t){return!(-1===(e=navigator.userAgent.toLowerCase()).indexOf("msie")&&-1===e.indexOf("trident")&&-1===e.indexOf(" edge/")||t&&t!==function(){var t=3,e=document.createElement("div"),i=e.getElementsByTagName("i");do{e.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e"}while(i[0]);return t>4?t:void 0}());var e},e.isLegacyOpera=function(){return!!window.opera}})),h=s((function(t){(t.exports={}).getOption=function(t,e,i){var n=t[e];return null==n&&void 0!==i?i:n}}));function c(){var t={},e=0,i=0,n=0;return{add:function(s,r){r||(r=s,s=0),s>i?i=s:s<n&&(n=s),t[s]||(t[s]=[]),t[s].push(r),e++},process:function(){for(var e=n;e<=i;e++)for(var s=t[e],r=0;r<s.length;r++)(0,s[r])()},size:function(){return e}}}var u="_erd";function a(t){return t[u]}var l={initState:function(t){return t[u]={},a(t)},getState:a,cleanState:function(t){delete t[u]}},f=r.forEach,d=r.forEach;function b(t){return Array.isArray(t)||void 0!==t.length}function m(t){if(Array.isArray(t))return t;var e=[];return d(t,(function(t){e.push(t)})),e}function v(t){return t&&1===t.nodeType}function p(t,e,i){var n=t[e];return null==n&&void 0!==i?i:n}var y=/^(%20|\s)*(javascript|data)/im,w=/[^\x20-\x7E]/gim,g=/^([^:]+):/gm,x=[".","/"],_=function(t){var e,i;return t?function(t){return x.indexOf(t[0])>-1}(i=t.replace(w,"").trim())?i:(e=i.match(g))&&y.test(e[0])?"about:blank":i:"about:blank"};function E(t){return"function"==typeof t}let S=!1;const k={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else S&&console.log("RxJS: Back to a better error behavior. Thank you. <3");S=t},get useDeprecatedSynchronousErrorHandling(){return S}};function A(t){setTimeout(()=>{throw t},0)}const C={closed:!0,next(t){},error(t){if(k.useDeprecatedSynchronousErrorHandling)throw t;A(t)},complete(){}},z=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))();function I(t){return null!==t&&"object"==typeof t}const O=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();class j{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:e,_unsubscribe:i,_subscriptions:n}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,e instanceof j)e.remove(this);else if(null!==e)for(let r=0;r<e.length;++r)e[r].remove(this);if(E(i))try{i.call(this)}catch(s){t=s instanceof O?D(s.errors):[s]}if(z(n)){let e=-1,i=n.length;for(;++e<i;){const i=n[e];if(I(i))try{i.unsubscribe()}catch(s){t=t||[],s instanceof O?t=t.concat(D(s.errors)):t.push(s)}}}if(t)throw new O(t)}add(t){let e=t;if(!t)return j.EMPTY;switch(typeof t){case"function":e=new j(t);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof j)){const t=e;(e=new j)._subscriptions=[t]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:i}=e;if(null===i)e._parentOrParents=this;else if(i instanceof j){if(i===this)return e;e._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return e;i.push(this)}const n=this._subscriptions;return null===n?this._subscriptions=[e]:n.push(e),e}remove(t){const e=this._subscriptions;if(e){const i=e.indexOf(t);-1!==i&&e.splice(i,1)}}}function D(t){return t.reduce((t,e)=>t.concat(e instanceof O?e.errors:e),[])}j.EMPTY=function(t){return t.closed=!0,t}(new j);const H=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class T extends j{constructor(t,e,i){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=C;break;case 1:if(!t){this.destination=C;break}if("object"==typeof t){t instanceof T?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new M(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new M(this,t,e,i)}}[H](){return this}static create(t,e,i){const n=new T(t,e,i);return n.syncErrorThrowable=!1,n}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class M extends T{constructor(t,e,i,n){let s;super(),this._parentSubscriber=t;let r=this;E(e)?s=e:e&&(s=e.next,i=e.error,n=e.complete,e!==C&&(E((r=Object.create(e)).unsubscribe)&&this.add(r.unsubscribe.bind(r)),r.unsubscribe=this.unsubscribe.bind(this))),this._context=r,this._next=s,this._error=i,this._complete=n}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;k.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:i}=k;if(this._error)i&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)i?(e.syncErrorValue=t,e.syncErrorThrown=!0):A(t),this.unsubscribe();else{if(this.unsubscribe(),i)throw t;A(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);k.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(i){if(this.unsubscribe(),k.useDeprecatedSynchronousErrorHandling)throw i;A(i)}}__tryOrSetError(t,e,i){if(!k.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,i)}catch(n){return k.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=n,t.syncErrorThrown=!0,!0):(A(n),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}const N=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function L(){}class P{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(t){const e=new P;return e.source=this,e.operator=t,e}subscribe(t,e,i){const{operator:n}=this,s=function(t,e,i){if(t){if(t instanceof T)return t;if(t[H])return t[H]()}return t||e||i?new T(t,e,i):new T(C)}(t,e,i);if(s.add(n?n.call(s,this.source):this.source||k.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),k.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s}_trySubscribe(t){try{return this._subscribe(t)}catch(e){k.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:i,isStopped:n}=t;if(e||n)return!1;t=i&&i instanceof T?i:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=R(e))((e,i)=>{let n;n=this.subscribe(e=>{try{t(e)}catch(s){i(s),n&&n.unsubscribe()}},i,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[N](){return this}pipe(...t){return 0===t.length?this:((e=t)?1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)}:L)(this);var e}toPromise(t){return new(t=R(t))((t,e)=>{let i;this.subscribe(t=>i=t,t=>e(t),()=>t(i))})}}function R(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}P.create=t=>new P(t);const U=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})();class q extends j{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const i=e.indexOf(this.subscriber);-1!==i&&e.splice(i,1)}}class $ extends T{constructor(t){super(t),this.destination=t}}class B extends P{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[H](){return new $(this)}lift(t){const e=new W(this,this);return e.operator=t,e}next(t){if(this.closed)throw new U;if(!this.isStopped){const{observers:e}=this,i=e.length,n=e.slice();for(let s=0;s<i;s++)n[s].next(t)}}error(t){if(this.closed)throw new U;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,i=e.length,n=e.slice();for(let s=0;s<i;s++)n[s].error(t);this.observers.length=0}complete(){if(this.closed)throw new U;this.isStopped=!0;const{observers:t}=this,e=t.length,i=t.slice();for(let n=0;n<e;n++)i[n].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new U;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new U;return this.hasError?(t.error(this.thrownError),j.EMPTY):this.isStopped?(t.complete(),j.EMPTY):(this.observers.push(t),new q(this,t))}asObservable(){const t=new P;return t.source=this,t}}B.create=(t,e)=>new W(t,e);class W extends B{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):j.EMPTY}}class Y extends j{constructor(t,e){super()}schedule(t,e=0){return this}}class J{constructor(t,e=J.now){this.SchedulerAction=t,this.now=e}schedule(t,e=0,i){return new this.SchedulerAction(this,t).schedule(i,e)}}J.now=()=>Date.now();class F extends J{constructor(t,e=J.now){super(t,()=>F.delegate&&F.delegate!==this?F.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,i){return F.delegate&&F.delegate!==this?F.delegate.schedule(t,e,i):super.schedule(t,e,i)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let i;this.active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}const G=new P(t=>t.complete());function K(t){return t&&"function"==typeof t.schedule}const V=t=>e=>{for(let i=0,n=t.length;i<n&&!e.closed;i++)e.next(t[i]);e.complete()};function X(t,e){return new P(i=>{const n=new j;let s=0;return n.add(e.schedule((function(){s!==t.length?(i.next(t[s++]),i.closed||n.add(this.schedule())):i.complete()}))),n})}const Q=new F(class extends Y{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this}requestAsyncId(t,e,i=0){return setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let i=!1,n=void 0;try{this.work(t)}catch(s){i=!0,n=!!s&&s||new Error(s)}if(i)return this.unsubscribe(),n}_unsubscribe(){const t=this.id,e=this.scheduler,i=e.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}});function Z(t){return t}const tt=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function et(t,e){return function(i){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return i.lift(new it(t,e))}}class it{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new nt(t,this.project,this.thisArg))}}class nt extends T{constructor(t,e,i){super(t),this.project=e,this.count=0,this.thisArg=i||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}class st extends T{notifyNext(t,e,i,n,s){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class rt extends T{constructor(t,e,i){super(),this.parent=t,this.outerValue=e,this.outerIndex=i,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}const ot="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",ht=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function ct(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}const ut=t=>{if(t&&"function"==typeof t[N])return(t=>e=>{const i=t[N]();if("function"!=typeof i.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return i.subscribe(e)})(t);if(ht(t))return V(t);if(ct(t))return(t=>e=>(t.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,A),e))(t);if(t&&"function"==typeof t[ot])return(t=>e=>{const i=t[ot]();for(;;){const t=i.next();if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof i.return&&e.add(()=>{i.return&&i.return()}),e})(t);{const e=I(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected.`+" You can provide an Observable, Promise, Array, or Iterable.")}};function at(t,e,i,n,s=new rt(t,i,n)){if(!s.closed)return e instanceof P?e.subscribe(s):ut(e)(s)}function lt(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[N]}(t))return function(t,e){return new P(i=>{const n=new j;return n.add(e.schedule(()=>{const s=t[N]();n.add(s.subscribe({next(t){n.add(e.schedule(()=>i.next(t)))},error(t){n.add(e.schedule(()=>i.error(t)))},complete(){n.add(e.schedule(()=>i.complete()))}}))})),n})}(t,e);if(ct(t))return function(t,e){return new P(i=>{const n=new j;return n.add(e.schedule(()=>t.then(t=>{n.add(e.schedule(()=>{i.next(t),n.add(e.schedule(()=>i.complete()))}))},t=>{n.add(e.schedule(()=>i.error(t)))}))),n})}(t,e);if(ht(t))return X(t,e);if(function(t){return t&&"function"==typeof t[ot]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new P(i=>{const n=new j;let s;return n.add(()=>{s&&"function"==typeof s.return&&s.return()}),n.add(e.schedule(()=>{s=t[ot](),n.add(e.schedule((function(){if(i.closed)return;let t,e;try{const i=s.next();t=i.value,e=i.done}catch(n){return void i.error(n)}e?i.complete():(i.next(t),this.schedule())})))})),n})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof P?t:new P(ut(t))}class ft{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new dt(t,this.project,this.concurrent))}}class dt extends st{constructor(t,e,i=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const i=this.index++;try{e=this.project(t,i)}catch(n){return void this.destination.error(n)}this.active++,this._innerSub(e,t,i)}_innerSub(t,e,i){const n=new rt(this,e,i),s=this.destination;s.add(n);const r=at(this,t,void 0,void 0,n);r!==n&&s.add(r)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t,e,i,n,s){this.destination.next(e)}notifyComplete(t){const e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function bt(t,e){return new P(i=>{const n=t.length;if(0===n)return void i.complete();const s=new Array(n);let r=0,o=0;for(let h=0;h<n;h++){const c=lt(t[h]);let u=!1;i.add(c.subscribe({next:t=>{u||(u=!0,o++),s[h]=t},error:t=>i.error(t),complete:()=>{++r!==n&&u||(o===n&&i.next(e?e.reduce((t,e,i)=>(t[e]=s[i],t),{}):s),i.complete())}}))}})}function mt(t,e,i,n){return E(i)&&(n=i,i=void 0),n?mt(t,e,i).pipe(et(t=>z(t)?n(...t):n(t))):new P(n=>{!function t(e,i,n,s,r){let o;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(e)){const t=e;e.addEventListener(i,n,r),o=()=>t.removeEventListener(i,n,r)}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(e)){const t=e;e.on(i,n),o=()=>t.off(i,n)}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(e)){const t=e;e.addListener(i,n),o=()=>t.removeListener(i,n)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let o=0,h=e.length;o<h;o++)t(e[o],i,n,s,r)}s.add(o)}(t,e,(function(t){n.next(arguments.length>1?Array.prototype.slice.call(arguments):t)}),n,i)})}function vt(t){return!z(t)&&t-parseFloat(t)+1>=0}function pt(...t){let e=Number.POSITIVE_INFINITY,i=null,n=t[t.length-1];return K(n)?(i=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof n&&(e=t.pop()),null===i&&1===t.length&&t[0]instanceof P?t[0]:function(t=Number.POSITIVE_INFINITY){return function t(e,i,n=Number.POSITIVE_INFINITY){return"function"==typeof i?s=>s.pipe(t((t,n)=>lt(e(t,n)).pipe(et((e,s)=>i(t,e,n,s))),n)):("number"==typeof i&&(n=i),t=>t.lift(new ft(e,n)))}(Z,t)}(e)(function(t,e){return e?X(t,e):new P(V(t))}(t,i))}function yt(t=0,e,i){let n=-1;return vt(e)?n=Number(e)<1?1:Number(e):K(e)&&(i=e),K(i)||(i=Q),new P(e=>{const s=vt(t)?t:+t-i.now();return i.schedule(wt,s,{index:0,period:n,subscriber:e})})}function wt(t){const{index:e,period:i,subscriber:n}=t;if(n.next(e),!n.closed){if(-1===i)return n.complete();t.index=e+1,this.schedule(t,i)}}class gt{constructor(t){this.durationSelector=t}call(t,e){return e.subscribe(new xt(t,this.durationSelector))}}class xt extends st{constructor(t,e){super(t),this.durationSelector=e,this.hasValue=!1,this.durationSubscription=null}_next(t){try{const e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(e){this.destination.error(e)}}_complete(){this.emitValue(),this.destination.complete()}_tryNext(t,e){let i=this.durationSubscription;this.value=t,this.hasValue=!0,i&&(i.unsubscribe(),this.remove(i)),(i=at(this,e))&&!i.closed&&this.add(this.durationSubscription=i)}notifyNext(t,e,i,n,s){this.emitValue()}notifyComplete(){this.emitValue()}emitValue(){if(this.hasValue){const t=this.value,e=this.durationSubscription;e&&(this.durationSubscription=null,e.unsubscribe(),this.remove(e)),this.value=null,this.hasValue=!1,super._next(t)}}}function _t(t){return e=>0===t?function(t){return t?function(t){return new P(e=>t.schedule(()=>e.complete()))}(t):G}():e.lift(new Et(t))}class Et{constructor(t){if(this.total=t,this.total<0)throw new tt}call(t,e){return e.subscribe(new St(t,this.total))}}class St extends T{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,i=++this.count;i<=e&&(this.destination.next(t),i===e&&(this.destination.complete(),this.unsubscribe()))}}class kt{constructor(t){this.project=t}call(t,e){return e.subscribe(new At(t,this.project))}}class At extends st{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const i=this.index++;try{e=this.project(t,i)}catch(n){return void this.destination.error(n)}this._innerSub(e,t,i)}_innerSub(t,e,i){const n=this.innerSubscription;n&&n.unsubscribe();const s=new rt(this,e,i),r=this.destination;r.add(s),this.innerSubscription=at(this,t,void 0,void 0,s),this.innerSubscription!==s&&r.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=null}notifyComplete(t){this.destination.remove(t),this.innerSubscription=null,this.isStopped&&super._complete()}notifyNext(t,e,i,n,s){this.destination.next(e)}}function Ct(t){return e=>e.lift(new zt(t))}class zt{constructor(t){this.notifier=t}call(t,e){const i=new It(t),n=at(i,this.notifier);return n&&!i.seenValue?(i.add(n),e.subscribe(i)):i}}class It extends st{constructor(t){super(t),this.seenValue=!1}notifyNext(t,e,i,n,s){this.seenValue=!0,this.complete()}notifyComplete(){}}class Ot{constructor(t,e,i){this.nextOrObserver=t,this.error=e,this.complete=i}call(t,e){return e.subscribe(new jt(t,this.nextOrObserver,this.error,this.complete))}}class jt extends T{constructor(t,e,i,n){super(t),this._tapNext=L,this._tapError=L,this._tapComplete=L,this._tapError=i||L,this._tapComplete=n||L,E(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||L,this._tapError=e.error||L,this._tapComplete=e.complete||L)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}const Dt=function(t){var e,i;if((t=t||{}).idHandler)e={get:function(e){return t.idHandler.get(e,!0)},set:t.idHandler.set};else{var n=function(t){var e=t.idGenerator,i=t.stateHandler.getState;return{get:function(t){var e=i(t);return e&&void 0!==e.id?e.id:null},set:function(t){var n=i(t);if(!n)throw new Error("setId required the element to have a resize detection state.");var s=e.generate();return n.id=s,s}}}({idGenerator:(i=1,{generate:function(){return i++}}),stateHandler:l});e=n}var s=t.reporter;s||(s=function(t){function e(){}var i={log:e,warn:e,error:e};if(!t&&window.console){var n=function(t,e){t[e]=function(){var t=console[e];if(t.apply)t.apply(console,arguments);else for(var i=0;i<arguments.length;i++)t(arguments[i])}};n(i,"log"),n(i,"warn"),n(i,"error")}return i}(!1===s));var r=p(t,"batchProcessor",function(t){var e=(t=t||{}).reporter,i=h.getOption(t,"async",!0),n=h.getOption(t,"auto",!0);n&&!i&&(e&&e.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),i=!0);var s,r=c(),o=!1;function u(){for(o=!0;r.size();){var t=r;r=c(),t.process()}o=!1}function a(){s=setTimeout(u,0)}return{add:function(t,e){!o&&n&&i&&0===r.size()&&a(),r.add(t,e)},force:function(t){o||(void 0===t&&(t=i),s&&(clearTimeout(s),s=null),t?a():u())}}}({reporter:s})),u={};u.callOnAdd=!!p(t,"callOnAdd",!0),u.debug=!!p(t,"debug",!1);var a,y=function(t){var e={};function i(i){var n=t.get(i);return void 0===n?[]:e[n]||[]}return{get:i,add:function(i,n){var s=t.get(i);e[s]||(e[s]=[]),e[s].push(n)},removeListener:function(t,e){for(var n=i(t),s=0,r=n.length;s<r;++s)if(n[s]===e){n.splice(s,1);break}},removeAllListeners:function(t){var e=i(t);e&&(e.length=0)}}}(e),w=function(){var t={stateHandler:l}.stateHandler.getState;return{isDetectable:function(e){var i=t(e);return i&&!!i.isDetectable},markAsDetectable:function(e){t(e).isDetectable=!0},isBusy:function(e){return!!t(e).busy},markBusy:function(e,i){t(e).busy=!!i}}}(),g=p(t,"strategy","object"),x=p(t,"important",!1),_={reporter:s,batchProcessor:r,stateHandler:l,idHandler:e,important:x};if("scroll"===g&&(o.isLegacyOpera()?(s.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),g="object"):o.isIE(9)&&(s.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),g="object")),"scroll"===g)a=function(t){var e=(t=t||{}).reporter,i=t.batchProcessor,n=t.stateHandler.getState,s=t.idHandler;if(!i)throw new Error("Missing required dependency: batchProcessor");if(!e)throw new Error("Missing required dependency: reporter.");var r=function(){var t=document.createElement("div");t.style.cssText=u(["position: absolute","width: 1000px","height: 1000px","visibility: hidden","margin: 0","padding: 0"]);var e=document.createElement("div");e.style.cssText=u(["position: absolute","width: 500px","height: 500px","overflow: scroll","visibility: none","top: -1500px","left: -1500px","visibility: hidden","margin: 0","padding: 0"]),e.appendChild(t),document.body.insertBefore(e,document.body.firstChild);var i=500-e.clientWidth,n=500-e.clientHeight;return document.body.removeChild(e),{width:i,height:n}}(),o="erd_scroll_detection_scrollbar_style",h="erd_scroll_detection_container";function c(t){!function(t,e,i){if(!t.getElementById(e)){var n=i+"_animation",s=i+"_animation_active",r="/* Created by the element-resize-detector library. */\n";r+="."+i+" > div::-webkit-scrollbar { "+u(["display: none"])+" }\n\n",r+="."+s+" { "+u(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+n,"animation-name: "+n])+" }\n",r+="@-webkit-keyframes "+n+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",function(i,n){n=n||function(e){t.head.appendChild(e)};var s=t.createElement("style");s.innerHTML=i,s.id=e,n(s)}(r+="@keyframes "+n+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}}(t,o,h)}function u(e){var i=t.important?" !important; ":"; ";return(e.join(i)+i).trim()}function a(t,i,n){if(t.addEventListener)t.addEventListener(i,n);else{if(!t.attachEvent)return e.error("[scroll] Don't know how to add event listeners.");t.attachEvent("on"+i,n)}}function l(t,i,n){if(t.removeEventListener)t.removeEventListener(i,n);else{if(!t.detachEvent)return e.error("[scroll] Don't know how to remove event listeners.");t.detachEvent("on"+i,n)}}function d(t){return n(t).container.childNodes[0].childNodes[0].childNodes[0]}function b(t){return n(t).container.childNodes[0].childNodes[0].childNodes[1]}return c(window.document),{makeDetectable:function(t,o,c){function l(){if(t.debug){var i=Array.prototype.slice.call(arguments);if(i.unshift(s.get(o),"Scroll: "),e.log.apply)e.log.apply(null,i);else for(var n=0;n<i.length;n++)e.log(i[n])}}function m(t){var e=n(t).container.childNodes[0],i=window.getComputedStyle(e);return!i.width||-1===i.width.indexOf("px")}function v(){var t=window.getComputedStyle(o),e={};return e.position=t.position,e.width=o.offsetWidth,e.height=o.offsetHeight,e.top=t.top,e.right=t.right,e.bottom=t.bottom,e.left=t.left,e.widthCSS=t.width,e.heightCSS=t.height,e}function p(){if(l("storeStyle invoked."),n(o)){var t=v();n(o).style=t}else l("Aborting because element has been uninstalled")}function y(t,e,i){n(t).lastWidth=e,n(t).lastHeight=i}function w(){return 2*r.width+1}function g(){return 2*r.height+1}function x(t){return t+10+w()}function _(t){return t+10+g()}function E(t,e,i){var n=d(t),s=b(t),r=x(e),o=_(i),h=function(t){return 2*t+w()}(e),c=function(t){return 2*t+g()}(i);n.scrollLeft=r,n.scrollTop=o,s.scrollLeft=h,s.scrollTop=c}function S(){var t=n(o).container;if(!t){(t=document.createElement("div")).className=h,t.style.cssText=u(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),n(o).container=t,function(t){t.className+=" "+h+"_animation_active"}(t),o.appendChild(t);var e=function(){n(o).onRendered&&n(o).onRendered()};a(t,"animationstart",e),n(o).onAnimationStart=e}return t}function k(){if(l("Injecting elements"),n(o)){!function(){var i=n(o).style;if("static"===i.position){o.style.setProperty("position","relative",t.important?"important":"");var s=function(t,e,i,n){var s=i[n];"auto"!==s&&"0"!==function(t){return t.replace(/[^-\d\.]/g,"")}(s)&&(t.warn("An element that is positioned static has style."+n+"="+s+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+n+" will be set to 0. Element: ",e),e.style[n]=0)};s(e,o,i,"top"),s(e,o,i,"right"),s(e,o,i,"bottom"),s(e,o,i,"left")}}();var i=n(o).container;i||(i=S());var s,c,f,d,b=r.width,m=r.height,v=u(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),p=u(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(["left: "+(s=(s=-(1+b))?s+"px":"0"),"top: "+(c=(c=-(1+m))?c+"px":"0"),"right: "+(d=(d=-b)?d+"px":"0"),"bottom: "+(f=(f=-m)?f+"px":"0")])),y=u(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),w=u(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),g=u(["position: absolute","left: 0","top: 0"]),x=u(["position: absolute","width: 200%","height: 200%"]),_=document.createElement("div"),E=document.createElement("div"),k=document.createElement("div"),A=document.createElement("div"),C=document.createElement("div"),z=document.createElement("div");_.dir="ltr",_.style.cssText=v,_.className=h,E.className=h,E.style.cssText=p,k.style.cssText=y,A.style.cssText=g,C.style.cssText=w,z.style.cssText=x,k.appendChild(A),C.appendChild(z),E.appendChild(k),E.appendChild(C),_.appendChild(E),i.appendChild(_),a(k,"scroll",I),a(C,"scroll",O),n(o).onExpandScroll=I,n(o).onShrinkScroll=O}else l("Aborting because element has been uninstalled");function I(){n(o).onExpand&&n(o).onExpand()}function O(){n(o).onShrink&&n(o).onShrink()}}function A(){function r(e,i,n){var s=function(t){return d(t).childNodes[0]}(e),r=x(i),o=_(n);s.style.setProperty("width",r+"px",t.important?"important":""),s.style.setProperty("height",o+"px",t.important?"important":"")}function h(h){var u=o.offsetWidth,a=o.offsetHeight,f=u!==n(o).lastWidth||a!==n(o).lastHeight;l("Storing current size",u,a),y(o,u,a),i.add(0,(function(){f&&(n(o)?c()?(t.debug&&(o.offsetWidth===u&&o.offsetHeight===a||e.warn(s.get(o),"Scroll: Size changed before updating detector elements.")),r(o,u,a)):l("Aborting because element container has not been initialized"):l("Aborting because element has been uninstalled"))})),i.add(1,(function(){n(o)?c()?E(o,u,a):l("Aborting because element container has not been initialized"):l("Aborting because element has been uninstalled")})),f&&h&&i.add(2,(function(){n(o)?c()?h():l("Aborting because element container has not been initialized"):l("Aborting because element has been uninstalled")}))}function c(){return!!n(o).container}function u(){l("notifyListenersIfNeeded invoked");var t=n(o);return void 0===n(o).lastNotifiedWidth&&t.lastWidth===t.startSize.width&&t.lastHeight===t.startSize.height?l("Not notifying: Size is the same as the start size, and there has been no notification yet."):t.lastWidth===t.lastNotifiedWidth&&t.lastHeight===t.lastNotifiedHeight?l("Not notifying: Size already notified"):(l("Current size not notified, notifying..."),t.lastNotifiedWidth=t.lastWidth,t.lastNotifiedHeight=t.lastHeight,void f(n(o).listeners,(function(t){t(o)})))}function a(){l("Scroll detected."),m(o)?l("Scroll event fired while unrendered. Ignoring..."):h(u)}if(l("registerListenersAndPositionElements invoked."),n(o)){n(o).onRendered=function(){if(l("startanimation triggered."),m(o))l("Ignoring since element is still unrendered...");else{l("Element rendered.");var t=d(o),e=b(o);0!==t.scrollLeft&&0!==t.scrollTop&&0!==e.scrollLeft&&0!==e.scrollTop||(l("Scrollbars out of sync. Updating detector elements..."),h(u))}},n(o).onExpand=a,n(o).onShrink=a;var v=n(o).style;r(o,v.width,v.height)}else l("Aborting because element has been uninstalled")}function C(){if(l("finalizeDomMutation invoked."),n(o)){var t=n(o).style;y(o,t.width,t.height),E(o,t.width,t.height)}else l("Aborting because element has been uninstalled")}function z(){c(o)}function I(){var t;l("Installing..."),n(o).listeners=[],t=v(),n(o).startSize={width:t.width,height:t.height},l("Element start size",n(o).startSize),i.add(0,p),i.add(1,k),i.add(2,A),i.add(3,C),i.add(4,z)}c||(c=o,o=t,t=null),t=t||{},l("Making detectable..."),function(t){return!function(t){return t===t.ownerDocument.body||t.ownerDocument.body.contains(t)}(t)||null===window.getComputedStyle(t)}(o)?(l("Element is detached"),S(),l("Waiting until element is attached..."),n(o).onRendered=function(){l("Element is now attached"),I()}):I()},addListener:function(t,e){if(!n(t).listeners.push)throw new Error("Cannot add listener to an element that is not detectable.");n(t).listeners.push(e)},uninstall:function(t){var e=n(t);e&&(e.onExpandScroll&&l(d(t),"scroll",e.onExpandScroll),e.onShrinkScroll&&l(b(t),"scroll",e.onShrinkScroll),e.onAnimationStart&&l(e.container,"animationstart",e.onAnimationStart),e.container&&t.removeChild(e.container))},initDocument:c}}(_);else{if("object"!==g)throw new Error("Invalid strategy name: "+g);a=function(t){var e=(t=t||{}).reporter,i=t.batchProcessor,n=t.stateHandler.getState;if(!e)throw new Error("Missing required dependency: reporter.");function s(e){var i=t.important?" !important; ":"; ";return(e.join(i)+i).trim()}function r(t){return n(t).object}return{makeDetectable:function(t,r,h){h||(h=r,r=t,t=null),t=t||{},o.isIE(8)?h(r):function(r,h){var c=s(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),u=!1,a=window.getComputedStyle(r),l=r.offsetWidth,f=r.offsetHeight;function d(){function i(){if("static"===a.position){r.style.setProperty("position","relative",t.important?"important":"");var i=function(e,i,n,s){var r=n[s];"auto"!==r&&"0"!==function(t){return t.replace(/[^-\d\.]/g,"")}(r)&&(e.warn("An element that is positioned static has style."+s+"="+r+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+s+" will be set to 0. Element: ",i),i.style.setProperty(s,"0",t.important?"important":""))};i(e,r,a,"top"),i(e,r,a,"right"),i(e,r,a,"bottom"),i(e,r,a,"left")}}""!==a.position&&(i(),u=!0);var s=document.createElement("object");s.style.cssText=c,s.tabIndex=-1,s.type="text/html",s.setAttribute("aria-hidden","true"),s.onload=function(){u||i(),function t(e,i){if(!e.contentDocument){var s=n(e);return s.checkForObjectDocumentTimeoutId&&window.clearTimeout(s.checkForObjectDocumentTimeoutId),void(s.checkForObjectDocumentTimeoutId=setTimeout((function(){s.checkForObjectDocumentTimeoutId=0,t(e,i)}),100))}i(e.contentDocument)}(this,(function(){h(r)}))},o.isIE()||(s.data="about:blank"),n(r)&&(r.appendChild(s),n(r).object=s,o.isIE()&&(s.data="about:blank"))}n(r).startSize={width:l,height:f},i?i.add(d):d()}(r,h)},addListener:function(t,e){function i(){e(t)}if(o.isIE(8))n(t).object={proxy:i},t.attachEvent("onresize",i);else{var s=r(t);if(!s)throw new Error("Element is not detectable by this strategy.");s.contentDocument.defaultView.addEventListener("resize",i)}},uninstall:function(t){if(n(t)){var e=r(t);e&&(o.isIE(8)?t.detachEvent("onresize",e.proxy):t.removeChild(e),n(t).checkForObjectDocumentTimeoutId&&window.clearTimeout(n(t).checkForObjectDocumentTimeoutId),delete n(t).object)}}}}(_)}var E={};return{listenTo:function(t,i,n){function r(t){var e=y.get(t);d(e,(function(e){e(t)}))}function o(t,e,i){y.add(e,i),t&&i(e)}if(n||(n=i,i=t,t={}),!i)throw new Error("At least one element required.");if(!n)throw new Error("Listener required.");if(v(i))i=[i];else{if(!b(i))return s.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");i=m(i)}var h=0,c=p(t,"callOnAdd",u.callOnAdd),f=p(t,"onReady",(function(){})),g=p(t,"debug",u.debug);d(i,(function(t){l.getState(t)||(l.initState(t),e.set(t));var u=e.get(t);if(g&&s.log("Attaching listener to element",u,t),!w.isDetectable(t))return g&&s.log(u,"Not detectable."),w.isBusy(t)?(g&&s.log(u,"System busy making it detectable"),o(c,t,n),E[u]=E[u]||[],void E[u].push((function(){++h===i.length&&f()}))):(g&&s.log(u,"Making detectable..."),w.markBusy(t,!0),a.makeDetectable({debug:g,important:x},t,(function(t){if(g&&s.log(u,"onElementDetectable"),l.getState(t)){w.markAsDetectable(t),w.markBusy(t,!1),a.addListener(t,r),o(c,t,n);var e=l.getState(t);e&&e.startSize&&(e.startSize.width===t.offsetWidth&&e.startSize.height===t.offsetHeight||r(t)),E[u]&&d(E[u],(function(t){t()}))}else g&&s.log(u,"Element uninstalled before being detectable.");delete E[u],++h===i.length&&f()})));g&&s.log(u,"Already detecable, adding listener."),o(c,t,n),h++})),h===i.length&&f()},removeListener:y.removeListener,removeAllListeners:y.removeAllListeners,uninstall:function(t){if(!t)return s.error("At least one element is required.");if(v(t))t=[t];else{if(!b(t))return s.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");t=m(t)}d(t,(function(t){y.removeAllListeners(t),a.uninstall(t),l.cleanState(t)}))},initDocument:function(t){a.initDocument&&a.initDocument(t)}}}({strategy:"scroll"}),Ht=class{constructor(i){t(this,i),this.ua=window.navigator.userAgent,this.msie=this.ua.indexOf("MSIE "),this.isIe=this.msie>0||!!navigator.userAgent.match(/Trident.*rv\:11\./),this.autoResize=!0,this.resizeDebounce=0,this.scaleDebounce=0,this.matchContentWidth=!1,this.scaleContent=!1,this.sanitizeSource=!0,this.maxHeight="5000vh",this.debug=!1,this.loaded=!1,this.loading=!0,this.pageTitle="SEB Magic Iframe",this._scale=1,this._hasBodyWidthRule=!1,this._stylesheets=[],this._unsubscribe$=new B,this.magicIframeEvent=e(this,"magicIframeEvent",7)}sourceChangeHandler(t,e){t!==e&&(this.loaded=!1)}scaleContentChangeHandler(t,e){t!==e&&(this.scale(),t&&(this.matchContentWidth=!1))}stylesChangeHandler(t,e){t!==e&&this.addCss()}styleUrlsChangeHandler(t,e){t!==e&&this.addStyleSheets()}autoResizeChangeHandler(t,e){t!==e&&(t?0===this.iframe.contentDocument.body.getElementsByClassName("erd_scroll_detection_container").length&&this.addElementResizeDetector(this.iframe.contentDocument.body,this.iframe.contentWindow.getComputedStyle(this.iframe.contentDocument.body)):this.removeElementResizeDetector())}matchContentWidthChangeHandler(t,e){t!==e&&this.hasBodyWidthRule()}loadedHandler(t,e){if(t!==e&&t){if(this.preventOverflow())return;this.magicIframeEventHandler({event:"iframe-loaded",details:this._loadEvent});const t=this.iframe.contentDocument.title;t!==this.pageTitle&&(this.pageTitle=t,this.magicIframeEventHandler({event:"iframe-title-change",details:t})),this.addCss(),this.addStyleSheets(),this.autoResize&&this.addElementResizeDetector(this.iframe.contentDocument.body,this.iframe.contentWindow.getComputedStyle(this.iframe.contentDocument.body)),this.addUnloadListener(),this.addClickListener(),this.addKeyUpListener(),this.scale()}else this.loading=!0}magicIframeEventHandler(t){this.debug&&console.log(t),this.magicIframeEvent.emit(t)}onIframeLoad(t){this._loadEvent=t,this.loaded=!0}getSafeSrc(){return this.sanitizeSource?_(this.source):this.source}render(){return i(n,{class:{loading:this.loading}},this.source?i("div",{style:this.loading&&{overflow:"hidden",position:"relative"}},i("div",{class:{"seb-iframe-loading":this.loading},style:!this.loading&&{visibility:"hidden"}},i("slot",null)),i("iframe",{src:this.getSafeSrc(),ref:t=>this.iframe=t,class:"seb-iframe",frameborder:"0",scrolling:"no",title:this.pageTitle,onLoad:t=>this.onIframeLoad(t)})):null)}addElementResizeDetector(t,e){Dt.listenTo(t,()=>{clearTimeout(this._resizeDebounceTimeout),this._resizeDebounceTimeout=setTimeout(()=>this.updateSize(e),this.resizeDebounce)})}updateSize(t){const e=t||this.iframe.contentWindow.getComputedStyle(this.iframe.contentDocument.body),i=(this.iframe.contentDocument.body.offsetHeight+parseInt(e.getPropertyValue("margin-top"),10)+parseInt(e.getPropertyValue("margin-bottom"),10))*this._scale,n=this.iframe.contentDocument.body.offsetWidth;this.iframe.style.height=`${i}px`,this.iframe.style.maxHeight=this.maxHeight,this.iframe.style.minWidth=!1!==this.matchContentWidth&&this._hasBodyWidthRule&&n&&!this.scaleContent||this.minWidth?this.minWidth||`${n}px`:"100%",this.magicIframeEventHandler({event:"iframe-resized",details:{width:n,height:i}})}addUnloadListener(){var t;this.isIe&&mt(this.iframe.contentWindow,"beforeunload").pipe((t=()=>{this.iframe.style.visibility="hidden",this.loading=!0},function(e){return e.lift(new Ot(t,void 0,void 0))}),function t(e,i){return"function"==typeof i?n=>n.pipe(t((t,n)=>lt(e(t,n)).pipe(et((e,s)=>i(t,e,n,s))))):t=>t.lift(new kt(e))}(()=>yt(3e3)),Ct(pt(mt(this.iframe.contentWindow,"unload"),this._unsubscribe$))).subscribe(()=>{this.iframe.style.visibility="visible",this.loading=!1}),mt(this.iframe.contentWindow,"unload").pipe(_t(1),Ct(this._unsubscribe$)).subscribe(t=>{this.loaded=!1,this.iframe.style.visibility="hidden",this.iframe.contentDocument.body.style.overflow="hidden",this.magicIframeEventHandler({event:"iframe-unloaded",details:t})})}addClickListener(){mt(this.iframe.contentDocument,"click").pipe(Ct(this._unsubscribe$)).subscribe(t=>{this.magicIframeEventHandler({event:"iframe-click",details:t})})}addKeyUpListener(){mt(this.iframe.contentDocument,"keyup").pipe(Ct(this._unsubscribe$)).subscribe(t=>{this.magicIframeEventHandler({event:"iframe-keyup",details:t})})}addCss(){if(this.styles&&this.styles.length>0){if(this._styleElement)try{this._styleElement.innerText=this.styles}catch(t){this._styleElement=document.createElement("style"),this._styleElement.setAttribute("id","sebMagicIframeStyles"),this._styleElement.appendChild(document.createTextNode(this.styles))}else this._styleElement=document.createElement("style"),this._styleElement.setAttribute("id","sebMagicIframeStyles"),this._styleElement.appendChild(document.createTextNode(this.styles));this.iframe.contentWindow.document.getElementsByTagName("head")[0].appendChild(this._styleElement),this.magicIframeEventHandler({event:"iframe-styles-added",details:this.styles})}else if(this._styleElement){let t=this.iframe.contentWindow.document.getElementById("sebMagicIframeStyles");t.parentNode.removeChild(t),this._styleElement=null,t=null,this.magicIframeEventHandler({event:"iframe-styles-removed",details:this.styles})}}preventOverflow(){try{const t=this.iframe.contentWindow.document.createElement("style");return this.iframe.contentWindow.document.body.style.position="static",this.styleElement=t,t.appendChild(document.createTextNode("html { overflow: hidden; }")),this.iframe.contentWindow.document.getElementsByTagName("head")[0].appendChild(t),!1}catch(t){return console.log("Event listeners and/or styles and resize listener could not be added due to a cross-origin frame error."),console.warn(t),this.magicIframeEventHandler({event:"iframe-loaded-with-errors",details:t}),this.iframe.style.visibility="visible",this.loading=!1,!0}}addStyleSheets(){if(this._stylesheets&&this._stylesheets.length>0){const t=this.iframe.contentDocument.head.querySelectorAll('link[data-seb-magic-iframe="true"]');if(t){for(let e=0;e<t.length;e++)t[e].parentNode.removeChild(t[e]);this.magicIframeEventHandler({event:"iframe-all-stylesheets-removed",details:this.styleUrls})}}if(this.styleUrls&&this.styleUrls.length>0){let t=[];this.styleUrls.map(e=>{const i=this.iframe.contentDocument.createElement("link");this._stylesheets=[...this._stylesheets,i],i.setAttribute("data-seb-magic-iframe","true"),i.rel="stylesheet",i.type="text/css",i.href=this.sanitizeSource?_(e):e;const n=new B;t=[...t,n],mt(i,"load").pipe(_t(1),Ct(this._unsubscribe$)).subscribe(()=>{this.magicIframeEventHandler({event:"iframe-stylesheet-loaded",details:e}),n.next(e),n.complete()}),this.iframe.contentDocument.head.insertBefore(i,this.styleElement),this.magicIframeEventHandler({event:"iframe-stylesheet-load",details:e})}),function(...t){if(1===t.length){const e=t[0];if(z(e))return bt(e,null);if(I(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return bt(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return bt(t=1===t.length&&z(t[0])?t[0]:t,null).pipe(et(t=>e(...t)))}return bt(t,null)}(t).pipe(_t(1),Ct(this._unsubscribe$)).subscribe(()=>{this.styleUrls.length>1&&this.magicIframeEventHandler({event:"iframe-all-stylesheets-loaded",details:this.styleUrls}),this.hasBodyWidthRule(),this.iframe.style.visibility="visible",this.loading=!1})}else this.hasBodyWidthRule(),this.iframe.style.visibility="visible",this.loading=!1}setScale(t){if(t)this._previousScale=t,this._scale=t;else{const t=this._previousScale&&this._hasBodyWidthRule?this._previousScale:this.iframe.clientWidth/this.iframe.contentDocument.body.offsetWidth;this._previousScale=null,this._scale=t>1?1:t}this.iframe.contentDocument.body.style.transformOrigin="top left",this.iframe.contentDocument.body.style.transform="scale3d("+this._scale+","+this._scale+",1)",this.updateSize(),(t||1!==this._scale)&&this.magicIframeEventHandler({event:"iframe-content-scaled",details:this._scale})}filterCssRuleBodyWidth(t){return t&&1===t.type&&"body"===t.selectorText&&(t.style.width||t.style.minWidth)}removeElementResizeDetector(){this.iframe.contentDocument.body&&Dt&&Dt.uninstall(this.iframe.contentDocument.body)}scale(){var t;this.scaleContent?(this.setScale(),this._resizeListener||(this._resizeListener=mt(window,"resize").pipe((t=()=>yt(this.scaleDebounce),e=>e.lift(new gt(t))),Ct(this._unsubscribe$)).subscribe(()=>this.setScale()))):!this.scaleContent&&this._resizeListener&&(this._resizeListener.unsubscribe(),this._resizeListener=null,this.setScale(1))}hasBodyWidthRule(){if("auto"!==this.matchContentWidth)return this._hasBodyWidthRule=this.matchContentWidth,void this.updateSize();try{let t=[].slice.call(this.iframe.contentDocument.styleSheets).reduce((t,e)=>e.cssRules?[...t,[].slice.call(e.cssRules).map(t=>4===t.type?[].slice.call(t.cssRules).filter(this.filterCssRuleBodyWidth).pop():t).filter(this.filterCssRuleBodyWidth).reduce((t,e)=>[...t,e.style.width||e.style.minWidth],[])]:[...t],[]);t=[].concat.apply([],t),this._hasBodyWidthRule=t.length>0,this.updateSize()}catch(t){console.log("Can't read css rules from stylesheet loaded from external domain."),console.warn(t)}}componentDidUnload(){this.magicIframeEventHandler({event:"iframe-removed",details:this.iframe}),this._unsubscribe$.next(),this._unsubscribe$.complete()}static get watchers(){return{source:["sourceChangeHandler"],scaleContent:["scaleContentChangeHandler"],styles:["stylesChangeHandler"],styleUrls:["styleUrlsChangeHandler"],autoResize:["autoResizeChangeHandler"],matchContentWidth:["matchContentWidthChangeHandler"],loaded:["loadedHandler"]}}static get style(){return":host{display:block;position:relative;-webkit-overflow-scrolling:touch;overflow:auto}.seb-iframe{overflow:hidden;min-width:100%;width:100px;*width:100%}.seb-iframe-loading{height:100%;width:100%;position:absolute;z-index:1}.seb-iframe-loading:after{background:#fff;content:\"\";display:block;height:100%;position:absolute;top:0;width:100%;z-index:-1;left:0}"}};export{Ht as seb_magic_iframe};